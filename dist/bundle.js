!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("phaser")):"function"==typeof define&&define.amd?define(["phaser"],e):"object"==typeof exports?exports.bundle=e(require("phaser")):t.bundle=e(t.phaser)}(window,(function(t){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var o=new Uint8Array(16);t.exports=function(){return n(o),o}}else{var r=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),r[e]=t>>>((3&e)<<3)&255;return r}}},function(t,e){for(var n=[],o=0;o<256;++o)n[o]=(o+256).toString(16).substr(1);t.exports=function(t,e){var o=e||0,r=n;return[r[t[o++]],r[t[o++]],r[t[o++]],r[t[o++]],"-",r[t[o++]],r[t[o++]],"-",r[t[o++]],r[t[o++]],"-",r[t[o++]],r[t[o++]],"-",r[t[o++]],r[t[o++]],r[t[o++]],r[t[o++]],r[t[o++]],r[t[o++]]].join("")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r={type:Phaser.AUTO,scale:{width:window.innerWidth,height:window.innerHeight},backgroundColor:"#000000",parent:"space-sim",physics:{default:"arcade",arcade:{gravity:{x:0,y:0}}},scene:o.GameScene};e.game=new Phaser.Game(r),window.addEventListener("resize",(function(){e.game.scale.refresh()}))},function(t,e,n){"use strict";var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),s=n(11),a={active:!0,visible:!0,key:"GameScene"},u=function(t){function e(){return t.call(this,a)||this}return r(e,t),e.prototype.preload=function(){},e.prototype.create=function(){var t={scene:this,x:200,y:200,texture:"./assets/sprites/ship-pod.png",frame:0};s.Globals.player=new i.ShipPod(t),this.followPlayer(),this.input.on("KEY_DOWN_P",(function(t){s.Globals.isPaused=!0})),this.input.on("KEY_DOWN_R",(function(){s.Globals.isPaused=!1}))},e.prototype.update=function(){s.Globals.isPaused||s.Globals.player.update()},e.prototype.followPlayer=function(){this.cameras.main.startFollow(s.Globals.player.getGameObject(),!1,.5,.1)},e}(Phaser.Scene);e.GameScene=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(5);n(9);var r=n(10),i=function(){function t(t){this.active=!0,this.fuelCapacity=100,this.remainingFuel=100,this.thrusterForce=1,this.thrusterFuelConsumption=.01,this.thrusterHeatGeneration=.5,this.rotationRate=.2,this.integrity=100,this.temperature=0,this.config=t,this.id=o.RNG.guid(),this.gameObj=this.config.scene.physics.add.sprite(this.config.scene.game.scale.width/2,this.config.scene.game.scale.height/2,"ship-pod"),this.setTarget(new r.Mouse(this.config.scene)),this.inputKeys=this.config.scene.input.keyboard.createCursorKeys()}return t.prototype.update=function(){this.lookAtTarget(),this.inputKeys.space.isDown&&this.thrustFowards(),this.applyCooling(),this.integrityCheck()},t.prototype.getRealPosition=function(){return new Phaser.Math.Vector2(this.gameObj.x,this.gameObj.y)},t.prototype.getPosition=function(){var t=this.config.scene.cameras.main.getWorldPoint(0,0);return new Phaser.Math.Vector2(this.gameObj.x-t.x,this.gameObj.y-t.y)},t.prototype.getId=function(){return this.id},t.prototype.getGameObject=function(){return this.gameObj},t.prototype.setTarget=function(t){this.target=t},t.prototype.lookAtTarget=function(){var t=this.target.getRealPosition(),e=Phaser.Math.Angle.Between(t.x,t.y,this.gameObj.x,this.gameObj.y);this.gameObj.setRotation(e)},t.prototype.thrustFowards=function(){if(this.remainingFuel>0){var t=new Phaser.Math.Vector2(Math.cos(Phaser.Math.Angle.CounterClockwise(this.gameObj.rotation)),Math.sin(Phaser.Math.Angle.CounterClockwise(this.gameObj.rotation))).clone().normalize().clone().multiply(new Phaser.Math.Vector2(this.thrusterForce,this.thrusterForce)),e=this.gameObj.body.velocity.add(t);this.gameObj.setVelocity(e.x,e.y),this.remainingFuel-=this.thrusterFuelConsumption,this.applyHeating(this.thrusterHeatGeneration)}},t.prototype.strafeLeft=function(){},t.prototype.strafeRight=function(){},t.prototype.thrustBackwards=function(){},t.prototype.applyHeating=function(t){if(this.temperature+=t,this.temperature>100){var e=this.temperature-100;this.integrity-=e}},t.prototype.applyCooling=function(){this.temperature>0&&(this.temperature-=.1),this.temperature<0&&(this.temperature=0)},t.prototype.integrityCheck=function(){this.integrity<=0&&(this.active=!1)},t}();e.ShipPod=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(6);!function(t){t.int=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},t.guid=function(){return o.v4()}}(e.RNG||(e.RNG={}))},function(t,e,n){var o=n(7),r=n(8),i=r;i.v1=o,i.v4=r,t.exports=i},function(t,e,n){var o,r,i=n(0),s=n(1),a=0,u=0;t.exports=function(t,e,n){var c=e&&n||0,p=e||[],l=(t=t||{}).node||o,h=void 0!==t.clockseq?t.clockseq:r;if(null==l||null==h){var f=i();null==l&&(l=o=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==h&&(h=r=16383&(f[6]<<8|f[7]))}var y=void 0!==t.msecs?t.msecs:(new Date).getTime(),d=void 0!==t.nsecs?t.nsecs:u+1,g=y-a+(d-u)/1e4;if(g<0&&void 0===t.clockseq&&(h=h+1&16383),(g<0||y>a)&&void 0===t.nsecs&&(d=0),d>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=y,u=d,r=h;var m=(1e4*(268435455&(y+=122192928e5))+d)%4294967296;p[c++]=m>>>24&255,p[c++]=m>>>16&255,p[c++]=m>>>8&255,p[c++]=255&m;var v=y/4294967296*1e4&268435455;p[c++]=v>>>8&255,p[c++]=255&v,p[c++]=v>>>24&15|16,p[c++]=v>>>16&255,p[c++]=h>>>8|128,p[c++]=255&h;for(var b=0;b<6;++b)p[c+b]=l[b];return e||s(p)}},function(t,e,n){var o=n(0),r=n(1);t.exports=function(t,e,n){var i=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||o)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var a=0;a<16;++a)e[i+a]=s[a];return e||r(s)}},function(e,n){e.exports=t},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t){var e=this;this.scene=t,this.location=Phaser.Math.Vector2.ZERO,this.scene.input.on("pointermove",(function(t){e.location=new Phaser.Math.Vector2(t.x,t.y)}))}return t.prototype.getPosition=function(){return console.log("mouse location: "+JSON.stringify(this.location)),this.location.clone()},t.prototype.getRealPosition=function(){var t=this.scene.cameras.main.getWorldPoint(this.location.x,this.location.y);return console.log("mouse REAL location: "+JSON.stringify(t)),t},t}();e.Mouse=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Globals||(e.Globals={})}])}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9idW5kbGUvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL2J1bmRsZS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9idW5kbGUvLi9ub2RlX21vZHVsZXMvdXVpZC9saWIvcm5nLWJyb3dzZXIuanMiLCJ3ZWJwYWNrOi8vYnVuZGxlLy4vbm9kZV9tb2R1bGVzL3V1aWQvbGliL2J5dGVzVG9VdWlkLmpzIiwid2VicGFjazovL2J1bmRsZS8uL3NyYy9nYW1lLnRzIiwid2VicGFjazovL2J1bmRsZS8uL3NyYy9nYW1lLXNjZW5lLnRzIiwid2VicGFjazovL2J1bmRsZS8uL3NyYy9zaGlwcy9zaGlwLXBvZC50cyIsIndlYnBhY2s6Ly9idW5kbGUvLi9zcmMvdXRpbGl0aWVzL3JuZy50cyIsIndlYnBhY2s6Ly9idW5kbGUvLi9ub2RlX21vZHVsZXMvdXVpZC9pbmRleC5qcyIsIndlYnBhY2s6Ly9idW5kbGUvLi9ub2RlX21vZHVsZXMvdXVpZC92MS5qcyIsIndlYnBhY2s6Ly9idW5kbGUvLi9ub2RlX21vZHVsZXMvdXVpZC92NC5qcyIsIndlYnBhY2s6Ly9idW5kbGUvZXh0ZXJuYWwgXCJwaGFzZXJcIiIsIndlYnBhY2s6Ly9idW5kbGUvLi9zcmMvdXRpbGl0aWVzL21vdXNlLnRzIiwid2VicGFjazovL2J1bmRsZS8uL3NyYy91dGlsaXRpZXMvZ2xvYmFscy50cyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJyZXF1aXJlIiwiZGVmaW5lIiwiYW1kIiwid2luZG93IiwiX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fOV9fIiwiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsImdldFJhbmRvbVZhbHVlcyIsImNyeXB0byIsIm1zQ3J5cHRvIiwicm5kczgiLCJVaW50OEFycmF5Iiwicm5kcyIsIkFycmF5IiwiTWF0aCIsInJhbmRvbSIsImJ5dGVUb0hleCIsInRvU3RyaW5nIiwic3Vic3RyIiwiYnVmIiwib2Zmc2V0IiwiYnRoIiwiam9pbiIsImdhbWVDb25maWciLCJ0eXBlIiwiUGhhc2VyIiwiQVVUTyIsInNjYWxlIiwid2lkdGgiLCJpbm5lcldpZHRoIiwiaGVpZ2h0IiwiaW5uZXJIZWlnaHQiLCJiYWNrZ3JvdW5kQ29sb3IiLCJwYXJlbnQiLCJwaHlzaWNzIiwiZGVmYXVsdCIsImFyY2FkZSIsImdyYXZpdHkiLCJ4IiwieSIsInNjZW5lIiwiR2FtZVNjZW5lIiwiZ2FtZSIsIkdhbWUiLCJhZGRFdmVudExpc3RlbmVyIiwicmVmcmVzaCIsInNjZW5lQ29uZmlnIiwiYWN0aXZlIiwidmlzaWJsZSIsInByZWxvYWQiLCJwb2RDb25maWciLCJ0aGlzIiwidGV4dHVyZSIsImZyYW1lIiwiR2xvYmFscyIsInBsYXllciIsIlNoaXBQb2QiLCJmb2xsb3dQbGF5ZXIiLCJpbnB1dCIsIm9uIiwiZXZlbnQiLCJpc1BhdXNlZCIsInVwZGF0ZSIsImNhbWVyYXMiLCJtYWluIiwic3RhcnRGb2xsb3ciLCJnZXRHYW1lT2JqZWN0IiwiU2NlbmUiLCJjb25maWciLCJmdWVsQ2FwYWNpdHkiLCJyZW1haW5pbmdGdWVsIiwidGhydXN0ZXJGb3JjZSIsInRocnVzdGVyRnVlbENvbnN1bXB0aW9uIiwidGhydXN0ZXJIZWF0R2VuZXJhdGlvbiIsInJvdGF0aW9uUmF0ZSIsImludGVncml0eSIsInRlbXBlcmF0dXJlIiwiaWQiLCJSTkciLCJndWlkIiwiZ2FtZU9iaiIsImFkZCIsInNwcml0ZSIsInNldFRhcmdldCIsIk1vdXNlIiwiaW5wdXRLZXlzIiwia2V5Ym9hcmQiLCJjcmVhdGVDdXJzb3JLZXlzIiwibG9va0F0VGFyZ2V0Iiwic3BhY2UiLCJpc0Rvd24iLCJ0aHJ1c3RGb3dhcmRzIiwiYXBwbHlDb29saW5nIiwiaW50ZWdyaXR5Q2hlY2siLCJnZXRSZWFsUG9zaXRpb24iLCJWZWN0b3IyIiwiZ2V0UG9zaXRpb24iLCJjYW1lcmFQb3MiLCJnZXRXb3JsZFBvaW50IiwiZ2V0SWQiLCJ0YXJnZXQiLCJwb3MiLCJyYWRpYW5zIiwiQW5nbGUiLCJCZXR3ZWVuIiwic2V0Um90YXRpb24iLCJmb3JjZSIsImNvcyIsIkNvdW50ZXJDbG9ja3dpc2UiLCJyb3RhdGlvbiIsInNpbiIsImNsb25lIiwibm9ybWFsaXplIiwibXVsdGlwbHkiLCJ2ZWxvY2l0eSIsImJvZHkiLCJzZXRWZWxvY2l0eSIsImFwcGx5SGVhdGluZyIsInN0cmFmZUxlZnQiLCJzdHJhZmVSaWdodCIsInRocnVzdEJhY2t3YXJkcyIsImRlZ3JlZXMiLCJkZWx0YSIsImludCIsIm1pbiIsIm1heCIsImZsb29yIiwidjQiLCJ2MSIsInV1aWQiLCJfbm9kZUlkIiwiX2Nsb2Nrc2VxIiwicm5nIiwiYnl0ZXNUb1V1aWQiLCJfbGFzdE1TZWNzIiwiX2xhc3ROU2VjcyIsIm9wdGlvbnMiLCJiIiwibm9kZSIsImNsb2Nrc2VxIiwidW5kZWZpbmVkIiwic2VlZEJ5dGVzIiwibXNlY3MiLCJEYXRlIiwiZ2V0VGltZSIsIm5zZWNzIiwiZHQiLCJFcnJvciIsInRsIiwidG1oIiwiaWkiLCJsb2NhdGlvbiIsIlpFUk8iLCJwb2ludGVyIiwiY29uc29sZSIsImxvZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJ3b3JsZCJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBMkNBLEVBQU1DLEdBQzFCLGlCQUFaQyxTQUEwQyxpQkFBWEMsT0FDeENBLE9BQU9ELFFBQVVELEVB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QUFRQSxFQUNiVyxLQUFLb0csU0FBVzlILE9BQU9YLEtBQUtpRixRQUFReUQsS0FDcENyRyxLQUFLWCxNQUFNa0IsTUFBTUMsR0FBRyxlQUFlLFNBQUM4RixHQUNoQyxFQUFLRixTQUFXLElBQUk5SCxPQUFPWCxLQUFLaUYsUUFBUTBELEVBQVFuSCxFQUFHbUgsRUFBUWxILE1Bc0J2RSxPQWJJLFlBQUF5RCxZQUFBLFdBRUksT0FEQTBELFFBQVFDLElBQUksbUJBQW1CQyxLQUFLQyxVQUFVMUcsS0FBS29HLFdBQzVDcEcsS0FBS29HLFNBQVN4QyxTQU16QixZQUFBakIsZ0JBQUEsV0FDSSxJQUFJZ0UsRUFBNkIzRyxLQUFLWCxNQUFNdUIsUUFBUUMsS0FBS2tDLGNBQWMvQyxLQUFLb0csU0FBU2pILEVBQUdhLEtBQUtvRyxTQUFTaEgsR0FFdEcsT0FEQW1ILFFBQVFDLElBQUksd0JBQXdCQyxLQUFLQyxVQUFVQyxJQUM1Q0EsR0FFZixFQTlCQSxHQUFhLEVBQUExRSxTLDhFQ0FDLEVBQUE5QixVQUFBLEVBQUFBLFFBQU8iLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKFwicGhhc2VyXCIpKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtcInBoYXNlclwiXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJidW5kbGVcIl0gPSBmYWN0b3J5KHJlcXVpcmUoXCJwaGFzZXJcIikpO1xuXHRlbHNlXG5cdFx0cm9vdFtcImJ1bmRsZVwiXSA9IGZhY3Rvcnkocm9vdFtcInBoYXNlclwiXSk7XG59KSh3aW5kb3csIGZ1bmN0aW9uKF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzlfXykge1xucmV0dXJuICIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAyKTtcbiIsIi8vIFVuaXF1ZSBJRCBjcmVhdGlvbiByZXF1aXJlcyBhIGhpZ2ggcXVhbGl0eSByYW5kb20gIyBnZW5lcmF0b3IuICBJbiB0aGVcbi8vIGJyb3dzZXIgdGhpcyBpcyBhIGxpdHRsZSBjb21wbGljYXRlZCBkdWUgdG8gdW5rbm93biBxdWFsaXR5IG9mIE1hdGgucmFuZG9tKClcbi8vIGFuZCBpbmNvbnNpc3RlbnQgc3VwcG9ydCBmb3IgdGhlIGBjcnlwdG9gIEFQSS4gIFdlIGRvIHRoZSBiZXN0IHdlIGNhbiB2aWFcbi8vIGZlYXR1cmUtZGV0ZWN0aW9uXG5cbi8vIGdldFJhbmRvbVZhbHVlcyBuZWVkcyB0byBiZSBpbnZva2VkIGluIGEgY29udGV4dCB3aGVyZSBcInRoaXNcIiBpcyBhIENyeXB0b1xuLy8gaW1wbGVtZW50YXRpb24uIEFsc28sIGZpbmQgdGhlIGNvbXBsZXRlIGltcGxlbWVudGF0aW9uIG9mIGNyeXB0byBvbiBJRTExLlxudmFyIGdldFJhbmRvbVZhbHVlcyA9ICh0eXBlb2YoY3J5cHRvKSAhPSAndW5kZWZpbmVkJyAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMuYmluZChjcnlwdG8pKSB8fFxuICAgICAgICAgICAgICAgICAgICAgICh0eXBlb2YobXNDcnlwdG8pICE9ICd1bmRlZmluZWQnICYmIHR5cGVvZiB3aW5kb3cubXNDcnlwdG8uZ2V0UmFuZG9tVmFsdWVzID09ICdmdW5jdGlvbicgJiYgbXNDcnlwdG8uZ2V0UmFuZG9tVmFsdWVzLmJpbmQobXNDcnlwdG8pKTtcblxuaWYgKGdldFJhbmRvbVZhbHVlcykge1xuICAvLyBXSEFUV0cgY3J5cHRvIFJORyAtIGh0dHA6Ly93aWtpLndoYXR3Zy5vcmcvd2lraS9DcnlwdG9cbiAgdmFyIHJuZHM4ID0gbmV3IFVpbnQ4QXJyYXkoMTYpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmXG5cbiAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiB3aGF0d2dSTkcoKSB7XG4gICAgZ2V0UmFuZG9tVmFsdWVzKHJuZHM4KTtcbiAgICByZXR1cm4gcm5kczg7XG4gIH07XG59IGVsc2Uge1xuICAvLyBNYXRoLnJhbmRvbSgpLWJhc2VkIChSTkcpXG4gIC8vXG4gIC8vIElmIGFsbCBlbHNlIGZhaWxzLCB1c2UgTWF0aC5yYW5kb20oKS4gIEl0J3MgZmFzdCwgYnV0IGlzIG9mIHVuc3BlY2lmaWVkXG4gIC8vIHF1YWxpdHkuXG4gIHZhciBybmRzID0gbmV3IEFycmF5KDE2KTtcblxuICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIG1hdGhSTkcoKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIHI7IGkgPCAxNjsgaSsrKSB7XG4gICAgICBpZiAoKGkgJiAweDAzKSA9PT0gMCkgciA9IE1hdGgucmFuZG9tKCkgKiAweDEwMDAwMDAwMDtcbiAgICAgIHJuZHNbaV0gPSByID4+PiAoKGkgJiAweDAzKSA8PCAzKSAmIDB4ZmY7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJuZHM7XG4gIH07XG59XG4iLCIvKipcbiAqIENvbnZlcnQgYXJyYXkgb2YgMTYgYnl0ZSB2YWx1ZXMgdG8gVVVJRCBzdHJpbmcgZm9ybWF0IG9mIHRoZSBmb3JtOlxuICogWFhYWFhYWFgtWFhYWC1YWFhYLVhYWFgtWFhYWFhYWFhYWFhYXG4gKi9cbnZhciBieXRlVG9IZXggPSBbXTtcbmZvciAodmFyIGkgPSAwOyBpIDwgMjU2OyArK2kpIHtcbiAgYnl0ZVRvSGV4W2ldID0gKGkgKyAweDEwMCkudG9TdHJpbmcoMTYpLnN1YnN0cigxKTtcbn1cblxuZnVuY3Rpb24gYnl0ZXNUb1V1aWQoYnVmLCBvZmZzZXQpIHtcbiAgdmFyIGkgPSBvZmZzZXQgfHwgMDtcbiAgdmFyIGJ0aCA9IGJ5dGVUb0hleDtcbiAgLy8gam9pbiB1c2VkIHRvIGZpeCBtZW1vcnkgaXNzdWUgY2F1c2VkIGJ5IGNvbmNhdGVuYXRpb246IGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC92OC9pc3N1ZXMvZGV0YWlsP2lkPTMxNzUjYzRcbiAgcmV0dXJuIChbXG4gICAgYnRoW2J1ZltpKytdXSwgYnRoW2J1ZltpKytdXSxcbiAgICBidGhbYnVmW2krK11dLCBidGhbYnVmW2krK11dLCAnLScsXG4gICAgYnRoW2J1ZltpKytdXSwgYnRoW2J1ZltpKytdXSwgJy0nLFxuICAgIGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV0sICctJyxcbiAgICBidGhbYnVmW2krK11dLCBidGhbYnVmW2krK11dLCAnLScsXG4gICAgYnRoW2J1ZltpKytdXSwgYnRoW2J1ZltpKytdXSxcbiAgICBidGhbYnVmW2krK11dLCBidGhbYnVmW2krK11dLFxuICAgIGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV1cbiAgXSkuam9pbignJyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYnl0ZXNUb1V1aWQ7XG4iLCJpbXBvcnQgeyBHYW1lU2NlbmUgfSBmcm9tIFwiLi9nYW1lLXNjZW5lXCI7XHJcblxyXG5jb25zdCBnYW1lQ29uZmlnOiBQaGFzZXIuVHlwZXMuQ29yZS5HYW1lQ29uZmlnID0ge1xyXG4gICAgdHlwZTogUGhhc2VyLkFVVE8sXHJcbiAgICBzY2FsZToge1xyXG4gICAgICAgIHdpZHRoOiB3aW5kb3cuaW5uZXJXaWR0aCxcclxuICAgICAgICBoZWlnaHQ6IHdpbmRvdy5pbm5lckhlaWdodFxyXG4gICAgfSxcclxuICAgIGJhY2tncm91bmRDb2xvcjogJyMwMDAwMDAnLFxyXG4gICAgcGFyZW50OiAnc3BhY2Utc2ltJyxcclxuICAgIHBoeXNpY3M6IHtcclxuICAgICAgICBkZWZhdWx0OiAnYXJjYWRlJyxcclxuICAgICAgICBhcmNhZGU6IHtcclxuICAgICAgICAgICAgZ3Jhdml0eTogeyB4OiAwLCB5OiAwIH0sXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNjZW5lOiBHYW1lU2NlbmVcclxufTtcclxuZXhwb3J0IGNvbnN0IGdhbWU6IFBoYXNlci5HYW1lID0gbmV3IFBoYXNlci5HYW1lKGdhbWVDb25maWcpO1xyXG5cclxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsICgpID0+IHtcclxuICAgIGdhbWUuc2NhbGUucmVmcmVzaCgpO1xyXG59KTsiLCJpbXBvcnQgeyBTaGlwUG9kIH0gZnJvbSBcIi4vc2hpcHMvc2hpcC1wb2RcIjtcclxuaW1wb3J0IHsgU2hpcFBvZENvbmZpZyB9IGZyb20gXCIuL3NoaXBzL3NoaXAtcG9kLWNvbmZpZ1wiO1xyXG5pbXBvcnQgeyBHbG9iYWxzIH0gZnJvbSBcIi4vdXRpbGl0aWVzL2dsb2JhbHNcIjtcclxuXHJcbmNvbnN0IHNjZW5lQ29uZmlnOiBQaGFzZXIuVHlwZXMuU2NlbmVzLlNldHRpbmdzQ29uZmlnID0ge1xyXG4gICAgYWN0aXZlOiB0cnVlLFxyXG4gICAgdmlzaWJsZTogdHJ1ZSxcclxuICAgIGtleTogJ0dhbWVTY2VuZSdcclxufTtcclxuXHJcbmV4cG9ydCBjbGFzcyBHYW1lU2NlbmUgZXh0ZW5kcyBQaGFzZXIuU2NlbmUge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoc2NlbmVDb25maWcpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBwcmVsb2FkKCk6IHZvaWQge1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjcmVhdGUoKTogdm9pZCB7XHJcbiAgICAgICAgbGV0IHBvZENvbmZpZzogU2hpcFBvZENvbmZpZyA9IHtcclxuICAgICAgICAgICAgc2NlbmU6IHRoaXMsXHJcbiAgICAgICAgICAgIHg6IDIwMCxcclxuICAgICAgICAgICAgeTogMjAwLFxyXG4gICAgICAgICAgICB0ZXh0dXJlOiAnLi9hc3NldHMvc3ByaXRlcy9zaGlwLXBvZC5wbmcnLFxyXG4gICAgICAgICAgICBmcmFtZTogMFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgR2xvYmFscy5wbGF5ZXIgPSBuZXcgU2hpcFBvZChwb2RDb25maWcpO1xyXG5cclxuICAgICAgICB0aGlzLmZvbGxvd1BsYXllcigpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuaW5wdXQub24oJ0tFWV9ET1dOX1AnLCAoZXZlbnQpID0+IHtcclxuICAgICAgICAgICAgR2xvYmFscy5pc1BhdXNlZCA9IHRydWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5pbnB1dC5vbignS0VZX0RPV05fUicsICgpID0+IHtcclxuICAgICAgICAgICAgR2xvYmFscy5pc1BhdXNlZCA9IGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyB1cGRhdGUoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKCFHbG9iYWxzLmlzUGF1c2VkKSB7XHJcbiAgICAgICAgICAgIEdsb2JhbHMucGxheWVyLnVwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGZvbGxvd1BsYXllcigpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmNhbWVyYXMubWFpbi5zdGFydEZvbGxvdyhHbG9iYWxzLnBsYXllci5nZXRHYW1lT2JqZWN0KCksIGZhbHNlLCAwLjUsIDAuMSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBSTkcgfSBmcm9tIFwiLi4vdXRpbGl0aWVzL3JuZ1wiO1xyXG5pbXBvcnQgXCJwaGFzZXJcIjtcclxuaW1wb3J0IHsgU2hpcFBvZENvbmZpZyB9IGZyb20gXCIuL3NoaXAtcG9kLWNvbmZpZ1wiO1xyXG5pbXBvcnQgeyBVcGRhdGFibGUgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy91cGRhdGFibGVcIjtcclxuaW1wb3J0IHsgQ2FuVGFyZ2V0IH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvY2FuLXRhcmdldFwiO1xyXG5pbXBvcnQgeyBDYW5UaHJ1c3QgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9jYW4tdGhydXN0XCI7XHJcbmltcG9ydCB7IEhhc0xvY2F0aW9uIH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvaGFzLWxvY2F0aW9uXCI7XHJcbmltcG9ydCB7IE1vdXNlIH0gZnJvbSBcIi4uL3V0aWxpdGllcy9tb3VzZVwiO1xyXG5pbXBvcnQgeyBIYXNHYW1lT2JqZWN0IH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvaGFzLWdhbWUtb2JqZWN0XCI7XHJcblxyXG5leHBvcnQgY2xhc3MgU2hpcFBvZCBpbXBsZW1lbnRzIFVwZGF0YWJsZSwgQ2FuVGFyZ2V0LCBDYW5UaHJ1c3QsIEhhc0xvY2F0aW9uLCBIYXNHYW1lT2JqZWN0IHtcclxuICAgIHByaXZhdGUgaWQ6IHN0cmluZzsgLy8gVVVJRFxyXG4gICAgcHJpdmF0ZSBjb25maWc6IFNoaXBQb2RDb25maWc7XHJcbiAgICBwcml2YXRlIGdhbWVPYmo6IFBoYXNlci5QaHlzaWNzLkFyY2FkZS5TcHJpdGU7XHJcbiAgICBwcml2YXRlIHRhcmdldDogSGFzTG9jYXRpb247XHJcbiAgICBwcml2YXRlIGlucHV0S2V5czogUGhhc2VyLlR5cGVzLklucHV0LktleWJvYXJkLkN1cnNvcktleXM7XHJcblxyXG4gICAgYWN0aXZlOiBib29sZWFuID0gdHJ1ZTtcclxuICAgIFxyXG4gICAgZnVlbENhcGFjaXR5OiBudW1iZXIgPSAxMDA7XHJcbiAgICByZW1haW5pbmdGdWVsOiBudW1iZXIgPSAxMDA7XHJcbiAgICBcclxuICAgIHRocnVzdGVyRm9yY2U6IG51bWJlciA9IDE7IC8vIEtpbG9OZXd0b25zXHJcbiAgICB0aHJ1c3RlckZ1ZWxDb25zdW1wdGlvbjogbnVtYmVyID0gMC4wMTtcclxuICAgIHRocnVzdGVySGVhdEdlbmVyYXRpb246IG51bWJlciA9IDAuNTtcclxuXHJcbiAgICByb3RhdGlvblJhdGU6IG51bWJlciA9IDAuMjsgLy8gZGVncmVlcyBwZXIgc2Vjb25kXHJcbiAgICBpbnRlZ3JpdHk6IG51bWJlciA9IDEwMDsgLy8gbWF4aW11bSBvZiAxMDBcclxuICAgIHRlbXBlcmF0dXJlOiBudW1iZXIgPSAwOyAvLyBpbiBDZWxjaXVzXHJcblxyXG4gICAgY29uc3RydWN0b3IoY29uZmlnOiBTaGlwUG9kQ29uZmlnKSB7XHJcbiAgICAgICAgdGhpcy5jb25maWcgPSBjb25maWc7XHJcbiAgICAgICAgdGhpcy5pZCA9IFJORy5ndWlkKCk7XHJcblxyXG4gICAgICAgIHRoaXMuZ2FtZU9iaiA9IHRoaXMuY29uZmlnLnNjZW5lLnBoeXNpY3MuYWRkLnNwcml0ZSh0aGlzLmNvbmZpZy5zY2VuZS5nYW1lLnNjYWxlLndpZHRoIC8gMiwgdGhpcy5jb25maWcuc2NlbmUuZ2FtZS5zY2FsZS5oZWlnaHQgLyAyLCAnc2hpcC1wb2QnKTtcclxuICAgICAgICB0aGlzLnNldFRhcmdldChuZXcgTW91c2UodGhpcy5jb25maWcuc2NlbmUpKTtcclxuICAgICAgICB0aGlzLmlucHV0S2V5cyA9IHRoaXMuY29uZmlnLnNjZW5lLmlucHV0LmtleWJvYXJkLmNyZWF0ZUN1cnNvcktleXMoKTtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGUoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5sb29rQXRUYXJnZXQoKTtcclxuICAgICAgICBpZiAodGhpcy5pbnB1dEtleXMuc3BhY2UuaXNEb3duKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGhydXN0Rm93YXJkcygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmFwcGx5Q29vbGluZygpO1xyXG4gICAgICAgIHRoaXMuaW50ZWdyaXR5Q2hlY2soKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRPRE86IG5lZWRlZCBzbyB3ZSBjYW4gdXNlIEZsb2F0aW5nIE9yaWdpblxyXG4gICAgICovXHJcbiAgICBnZXRSZWFsUG9zaXRpb24oKTogUGhhc2VyLk1hdGguVmVjdG9yMiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQaGFzZXIuTWF0aC5WZWN0b3IyKHRoaXMuZ2FtZU9iai54LCB0aGlzLmdhbWVPYmoueSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiB0aGUgbG9jYXRpb24gd2l0aGluIHRoZSB2aWV3YWJsZSBhcmVhXHJcbiAgICAgKiBAcmV0dXJucyBhIHtQaGFzZXIuTWF0aC5WZWN0b3IyfSBvZmZzZXQgZm9yIGxvY2F0aW9uIHdpdGhpbiBjdXJyZW50IFxyXG4gICAgICogdmlld2FibGUgYXJlYVxyXG4gICAgICovXHJcbiAgICBnZXRQb3NpdGlvbigpOiBQaGFzZXIuTWF0aC5WZWN0b3IyIHtcclxuICAgICAgICBsZXQgY2FtZXJhUG9zOiBQaGFzZXIuTWF0aC5WZWN0b3IyID0gdGhpcy5jb25maWcuc2NlbmUuY2FtZXJhcy5tYWluLmdldFdvcmxkUG9pbnQoMCwgMCk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQaGFzZXIuTWF0aC5WZWN0b3IyKHRoaXMuZ2FtZU9iai54IC0gY2FtZXJhUG9zLngsIHRoaXMuZ2FtZU9iai55IC0gY2FtZXJhUG9zLnkpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldElkKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaWQ7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0R2FtZU9iamVjdCgpOiBQaGFzZXIuR2FtZU9iamVjdHMuR2FtZU9iamVjdCB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2FtZU9iajtcclxuICAgIH1cclxuXHJcbiAgICBzZXRUYXJnZXQodGFyZ2V0OiBIYXNMb2NhdGlvbikge1xyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICAgfVxyXG5cclxuICAgIGxvb2tBdFRhcmdldCgpOiB2b2lkIHtcclxuICAgICAgICBsZXQgcG9zID0gdGhpcy50YXJnZXQuZ2V0UmVhbFBvc2l0aW9uKCk7XHJcbiAgICAgICAgbGV0IHJhZGlhbnM6IG51bWJlciA9IFBoYXNlci5NYXRoLkFuZ2xlLkJldHdlZW4ocG9zLngsIHBvcy55LCB0aGlzLmdhbWVPYmoueCwgdGhpcy5nYW1lT2JqLnkpO1xyXG4gICAgICAgIHRoaXMuZ2FtZU9iai5zZXRSb3RhdGlvbihyYWRpYW5zKTtcclxuICAgIH1cclxuXHJcbiAgICB0aHJ1c3RGb3dhcmRzKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLnJlbWFpbmluZ0Z1ZWwgPiAwKSB7XHJcbiAgICAgICAgICAgIGxldCBkZWx0YTogUGhhc2VyLk1hdGguVmVjdG9yMiA9IG5ldyBQaGFzZXIuTWF0aC5WZWN0b3IyKE1hdGguY29zKFBoYXNlci5NYXRoLkFuZ2xlLkNvdW50ZXJDbG9ja3dpc2UodGhpcy5nYW1lT2JqLnJvdGF0aW9uKSksIE1hdGguc2luKFBoYXNlci5NYXRoLkFuZ2xlLkNvdW50ZXJDbG9ja3dpc2UodGhpcy5nYW1lT2JqLnJvdGF0aW9uKSkpO1xyXG4gICAgICAgICAgICAvLyBsZXQgZGVsdGE6IFBoYXNlci5NYXRoLlZlY3RvcjIgPSBtb3VzZVBvc2l0aW9uLmNsb25lKCkuc3VidHJhY3QobmV3IFBoYXNlci5NYXRoLlZlY3RvcjIodGhpcy5nYW1lT2JqLngsIHRoaXMuZ2FtZU9iai55KSk7XHJcbiAgICAgICAgICAgIGxldCBub3JtYWxpc2VkRGVsdGE6IFBoYXNlci5NYXRoLlZlY3RvcjIgPSBkZWx0YS5jbG9uZSgpLm5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICAgICBsZXQgZm9yY2U6IFBoYXNlci5NYXRoLlZlY3RvcjIgPSBub3JtYWxpc2VkRGVsdGEuY2xvbmUoKS5tdWx0aXBseShuZXcgUGhhc2VyLk1hdGguVmVjdG9yMih0aGlzLnRocnVzdGVyRm9yY2UsIHRoaXMudGhydXN0ZXJGb3JjZSkpO1xyXG4gICAgICAgICAgICBsZXQgdiA9IHRoaXMuZ2FtZU9iai5ib2R5LnZlbG9jaXR5O1xyXG4gICAgICAgICAgICBsZXQgdmVsb2NpdHkgPSB2LmFkZChmb3JjZSk7XHJcbiAgICAgICAgICAgIHRoaXMuZ2FtZU9iai5zZXRWZWxvY2l0eSh2ZWxvY2l0eS54LCB2ZWxvY2l0eS55KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucmVtYWluaW5nRnVlbCAtPSB0aGlzLnRocnVzdGVyRnVlbENvbnN1bXB0aW9uO1xyXG4gICAgICAgICAgICB0aGlzLmFwcGx5SGVhdGluZyh0aGlzLnRocnVzdGVySGVhdEdlbmVyYXRpb24pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzdHJhZmVMZWZ0KCk6IHZvaWQge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzdHJhZmVSaWdodCgpOiB2b2lkIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdGhydXN0QmFja3dhcmRzKCk6IHZvaWQge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBhcHBseUhlYXRpbmcoZGVncmVlczogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy50ZW1wZXJhdHVyZSArPSBkZWdyZWVzO1xyXG4gICAgICAgIGlmICh0aGlzLnRlbXBlcmF0dXJlID4gMTAwKSB7XHJcbiAgICAgICAgICAgIC8vIHJlZHVjZSBpbnRlZ3JpdHkgYmFzZWQgb24gZGVncmVlcyBvdmVyIDEwMFxyXG4gICAgICAgICAgICBsZXQgZGVsdGE6IG51bWJlciA9IHRoaXMudGVtcGVyYXR1cmUgLSAxMDA7XHJcbiAgICAgICAgICAgIHRoaXMuaW50ZWdyaXR5IC09IGRlbHRhO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhcHBseUNvb2xpbmcoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMudGVtcGVyYXR1cmUgPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGVtcGVyYXR1cmUgLT0gMC4xO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy50ZW1wZXJhdHVyZSA8IDApIHtcclxuICAgICAgICAgICAgdGhpcy50ZW1wZXJhdHVyZSA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGludGVncml0eUNoZWNrKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmludGVncml0eSA8PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IGRlc3Ryb3kgc2hpcCBhbmQgZW5kIGdhbWVcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyB2NCB9IGZyb20gXCJ1dWlkXCI7XHJcblxyXG5leHBvcnQgbW9kdWxlIFJORyB7XHJcbiAgICBleHBvcnQgZnVuY3Rpb24gaW50KG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSkgKyBtaW47XHJcbiAgICB9XHJcblxyXG4gICAgZXhwb3J0IGZ1bmN0aW9uIGd1aWQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdjQoKTtcclxuICAgIH1cclxufSIsInZhciB2MSA9IHJlcXVpcmUoJy4vdjEnKTtcbnZhciB2NCA9IHJlcXVpcmUoJy4vdjQnKTtcblxudmFyIHV1aWQgPSB2NDtcbnV1aWQudjEgPSB2MTtcbnV1aWQudjQgPSB2NDtcblxubW9kdWxlLmV4cG9ydHMgPSB1dWlkO1xuIiwidmFyIHJuZyA9IHJlcXVpcmUoJy4vbGliL3JuZycpO1xudmFyIGJ5dGVzVG9VdWlkID0gcmVxdWlyZSgnLi9saWIvYnl0ZXNUb1V1aWQnKTtcblxuLy8gKipgdjEoKWAgLSBHZW5lcmF0ZSB0aW1lLWJhc2VkIFVVSUQqKlxuLy9cbi8vIEluc3BpcmVkIGJ5IGh0dHBzOi8vZ2l0aHViLmNvbS9MaW9zSy9VVUlELmpzXG4vLyBhbmQgaHR0cDovL2RvY3MucHl0aG9uLm9yZy9saWJyYXJ5L3V1aWQuaHRtbFxuXG52YXIgX25vZGVJZDtcbnZhciBfY2xvY2tzZXE7XG5cbi8vIFByZXZpb3VzIHV1aWQgY3JlYXRpb24gdGltZVxudmFyIF9sYXN0TVNlY3MgPSAwO1xudmFyIF9sYXN0TlNlY3MgPSAwO1xuXG4vLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkIGZvciBBUEkgZGV0YWlsc1xuZnVuY3Rpb24gdjEob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgdmFyIGkgPSBidWYgJiYgb2Zmc2V0IHx8IDA7XG4gIHZhciBiID0gYnVmIHx8IFtdO1xuXG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICB2YXIgbm9kZSA9IG9wdGlvbnMubm9kZSB8fCBfbm9kZUlkO1xuICB2YXIgY2xvY2tzZXEgPSBvcHRpb25zLmNsb2Nrc2VxICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmNsb2Nrc2VxIDogX2Nsb2Nrc2VxO1xuXG4gIC8vIG5vZGUgYW5kIGNsb2Nrc2VxIG5lZWQgdG8gYmUgaW5pdGlhbGl6ZWQgdG8gcmFuZG9tIHZhbHVlcyBpZiB0aGV5J3JlIG5vdFxuICAvLyBzcGVjaWZpZWQuICBXZSBkbyB0aGlzIGxhemlseSB0byBtaW5pbWl6ZSBpc3N1ZXMgcmVsYXRlZCB0byBpbnN1ZmZpY2llbnRcbiAgLy8gc3lzdGVtIGVudHJvcHkuICBTZWUgIzE4OVxuICBpZiAobm9kZSA9PSBudWxsIHx8IGNsb2Nrc2VxID09IG51bGwpIHtcbiAgICB2YXIgc2VlZEJ5dGVzID0gcm5nKCk7XG4gICAgaWYgKG5vZGUgPT0gbnVsbCkge1xuICAgICAgLy8gUGVyIDQuNSwgY3JlYXRlIGFuZCA0OC1iaXQgbm9kZSBpZCwgKDQ3IHJhbmRvbSBiaXRzICsgbXVsdGljYXN0IGJpdCA9IDEpXG4gICAgICBub2RlID0gX25vZGVJZCA9IFtcbiAgICAgICAgc2VlZEJ5dGVzWzBdIHwgMHgwMSxcbiAgICAgICAgc2VlZEJ5dGVzWzFdLCBzZWVkQnl0ZXNbMl0sIHNlZWRCeXRlc1szXSwgc2VlZEJ5dGVzWzRdLCBzZWVkQnl0ZXNbNV1cbiAgICAgIF07XG4gICAgfVxuICAgIGlmIChjbG9ja3NlcSA9PSBudWxsKSB7XG4gICAgICAvLyBQZXIgNC4yLjIsIHJhbmRvbWl6ZSAoMTQgYml0KSBjbG9ja3NlcVxuICAgICAgY2xvY2tzZXEgPSBfY2xvY2tzZXEgPSAoc2VlZEJ5dGVzWzZdIDw8IDggfCBzZWVkQnl0ZXNbN10pICYgMHgzZmZmO1xuICAgIH1cbiAgfVxuXG4gIC8vIFVVSUQgdGltZXN0YW1wcyBhcmUgMTAwIG5hbm8tc2Vjb25kIHVuaXRzIHNpbmNlIHRoZSBHcmVnb3JpYW4gZXBvY2gsXG4gIC8vICgxNTgyLTEwLTE1IDAwOjAwKS4gIEpTTnVtYmVycyBhcmVuJ3QgcHJlY2lzZSBlbm91Z2ggZm9yIHRoaXMsIHNvXG4gIC8vIHRpbWUgaXMgaGFuZGxlZCBpbnRlcm5hbGx5IGFzICdtc2VjcycgKGludGVnZXIgbWlsbGlzZWNvbmRzKSBhbmQgJ25zZWNzJ1xuICAvLyAoMTAwLW5hbm9zZWNvbmRzIG9mZnNldCBmcm9tIG1zZWNzKSBzaW5jZSB1bml4IGVwb2NoLCAxOTcwLTAxLTAxIDAwOjAwLlxuICB2YXIgbXNlY3MgPSBvcHRpb25zLm1zZWNzICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLm1zZWNzIDogbmV3IERhdGUoKS5nZXRUaW1lKCk7XG5cbiAgLy8gUGVyIDQuMi4xLjIsIHVzZSBjb3VudCBvZiB1dWlkJ3MgZ2VuZXJhdGVkIGR1cmluZyB0aGUgY3VycmVudCBjbG9ja1xuICAvLyBjeWNsZSB0byBzaW11bGF0ZSBoaWdoZXIgcmVzb2x1dGlvbiBjbG9ja1xuICB2YXIgbnNlY3MgPSBvcHRpb25zLm5zZWNzICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLm5zZWNzIDogX2xhc3ROU2VjcyArIDE7XG5cbiAgLy8gVGltZSBzaW5jZSBsYXN0IHV1aWQgY3JlYXRpb24gKGluIG1zZWNzKVxuICB2YXIgZHQgPSAobXNlY3MgLSBfbGFzdE1TZWNzKSArIChuc2VjcyAtIF9sYXN0TlNlY3MpLzEwMDAwO1xuXG4gIC8vIFBlciA0LjIuMS4yLCBCdW1wIGNsb2Nrc2VxIG9uIGNsb2NrIHJlZ3Jlc3Npb25cbiAgaWYgKGR0IDwgMCAmJiBvcHRpb25zLmNsb2Nrc2VxID09PSB1bmRlZmluZWQpIHtcbiAgICBjbG9ja3NlcSA9IGNsb2Nrc2VxICsgMSAmIDB4M2ZmZjtcbiAgfVxuXG4gIC8vIFJlc2V0IG5zZWNzIGlmIGNsb2NrIHJlZ3Jlc3NlcyAobmV3IGNsb2Nrc2VxKSBvciB3ZSd2ZSBtb3ZlZCBvbnRvIGEgbmV3XG4gIC8vIHRpbWUgaW50ZXJ2YWxcbiAgaWYgKChkdCA8IDAgfHwgbXNlY3MgPiBfbGFzdE1TZWNzKSAmJiBvcHRpb25zLm5zZWNzID09PSB1bmRlZmluZWQpIHtcbiAgICBuc2VjcyA9IDA7XG4gIH1cblxuICAvLyBQZXIgNC4yLjEuMiBUaHJvdyBlcnJvciBpZiB0b28gbWFueSB1dWlkcyBhcmUgcmVxdWVzdGVkXG4gIGlmIChuc2VjcyA+PSAxMDAwMCkge1xuICAgIHRocm93IG5ldyBFcnJvcigndXVpZC52MSgpOiBDYW5cXCd0IGNyZWF0ZSBtb3JlIHRoYW4gMTBNIHV1aWRzL3NlYycpO1xuICB9XG5cbiAgX2xhc3RNU2VjcyA9IG1zZWNzO1xuICBfbGFzdE5TZWNzID0gbnNlY3M7XG4gIF9jbG9ja3NlcSA9IGNsb2Nrc2VxO1xuXG4gIC8vIFBlciA0LjEuNCAtIENvbnZlcnQgZnJvbSB1bml4IGVwb2NoIHRvIEdyZWdvcmlhbiBlcG9jaFxuICBtc2VjcyArPSAxMjIxOTI5MjgwMDAwMDtcblxuICAvLyBgdGltZV9sb3dgXG4gIHZhciB0bCA9ICgobXNlY3MgJiAweGZmZmZmZmYpICogMTAwMDAgKyBuc2VjcykgJSAweDEwMDAwMDAwMDtcbiAgYltpKytdID0gdGwgPj4+IDI0ICYgMHhmZjtcbiAgYltpKytdID0gdGwgPj4+IDE2ICYgMHhmZjtcbiAgYltpKytdID0gdGwgPj4+IDggJiAweGZmO1xuICBiW2krK10gPSB0bCAmIDB4ZmY7XG5cbiAgLy8gYHRpbWVfbWlkYFxuICB2YXIgdG1oID0gKG1zZWNzIC8gMHgxMDAwMDAwMDAgKiAxMDAwMCkgJiAweGZmZmZmZmY7XG4gIGJbaSsrXSA9IHRtaCA+Pj4gOCAmIDB4ZmY7XG4gIGJbaSsrXSA9IHRtaCAmIDB4ZmY7XG5cbiAgLy8gYHRpbWVfaGlnaF9hbmRfdmVyc2lvbmBcbiAgYltpKytdID0gdG1oID4+PiAyNCAmIDB4ZiB8IDB4MTA7IC8vIGluY2x1ZGUgdmVyc2lvblxuICBiW2krK10gPSB0bWggPj4+IDE2ICYgMHhmZjtcblxuICAvLyBgY2xvY2tfc2VxX2hpX2FuZF9yZXNlcnZlZGAgKFBlciA0LjIuMiAtIGluY2x1ZGUgdmFyaWFudClcbiAgYltpKytdID0gY2xvY2tzZXEgPj4+IDggfCAweDgwO1xuXG4gIC8vIGBjbG9ja19zZXFfbG93YFxuICBiW2krK10gPSBjbG9ja3NlcSAmIDB4ZmY7XG5cbiAgLy8gYG5vZGVgXG4gIGZvciAodmFyIG4gPSAwOyBuIDwgNjsgKytuKSB7XG4gICAgYltpICsgbl0gPSBub2RlW25dO1xuICB9XG5cbiAgcmV0dXJuIGJ1ZiA/IGJ1ZiA6IGJ5dGVzVG9VdWlkKGIpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHYxO1xuIiwidmFyIHJuZyA9IHJlcXVpcmUoJy4vbGliL3JuZycpO1xudmFyIGJ5dGVzVG9VdWlkID0gcmVxdWlyZSgnLi9saWIvYnl0ZXNUb1V1aWQnKTtcblxuZnVuY3Rpb24gdjQob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgdmFyIGkgPSBidWYgJiYgb2Zmc2V0IHx8IDA7XG5cbiAgaWYgKHR5cGVvZihvcHRpb25zKSA9PSAnc3RyaW5nJykge1xuICAgIGJ1ZiA9IG9wdGlvbnMgPT09ICdiaW5hcnknID8gbmV3IEFycmF5KDE2KSA6IG51bGw7XG4gICAgb3B0aW9ucyA9IG51bGw7XG4gIH1cbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgdmFyIHJuZHMgPSBvcHRpb25zLnJhbmRvbSB8fCAob3B0aW9ucy5ybmcgfHwgcm5nKSgpO1xuXG4gIC8vIFBlciA0LjQsIHNldCBiaXRzIGZvciB2ZXJzaW9uIGFuZCBgY2xvY2tfc2VxX2hpX2FuZF9yZXNlcnZlZGBcbiAgcm5kc1s2XSA9IChybmRzWzZdICYgMHgwZikgfCAweDQwO1xuICBybmRzWzhdID0gKHJuZHNbOF0gJiAweDNmKSB8IDB4ODA7XG5cbiAgLy8gQ29weSBieXRlcyB0byBidWZmZXIsIGlmIHByb3ZpZGVkXG4gIGlmIChidWYpIHtcbiAgICBmb3IgKHZhciBpaSA9IDA7IGlpIDwgMTY7ICsraWkpIHtcbiAgICAgIGJ1ZltpICsgaWldID0gcm5kc1tpaV07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGJ1ZiB8fCBieXRlc1RvVXVpZChybmRzKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB2NDtcbiIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fOV9fOyIsImltcG9ydCB7IEhhc0xvY2F0aW9uIH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvaGFzLWxvY2F0aW9uXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTW91c2UgaW1wbGVtZW50cyBIYXNMb2NhdGlvbiB7XHJcbiAgICBwcml2YXRlIHNjZW5lOiBQaGFzZXIuU2NlbmU7XHJcbiAgICBwcml2YXRlIGxvY2F0aW9uOiBQaGFzZXIuTWF0aC5WZWN0b3IyO1xyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcihzY2VuZTogUGhhc2VyLlNjZW5lKSB7XHJcbiAgICAgICAgdGhpcy5zY2VuZSA9IHNjZW5lO1xyXG4gICAgICAgIHRoaXMubG9jYXRpb24gPSBQaGFzZXIuTWF0aC5WZWN0b3IyLlpFUk87XHJcbiAgICAgICAgdGhpcy5zY2VuZS5pbnB1dC5vbigncG9pbnRlcm1vdmUnLCAocG9pbnRlcikgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmxvY2F0aW9uID0gbmV3IFBoYXNlci5NYXRoLlZlY3RvcjIocG9pbnRlci54LCBwb2ludGVyLnkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogcmV0dXJucyB0aGUgcG9zaXRpb24gb2YgdGhlIG1vdXNlIHdpdGhpbiB0aGUgYm91bmRzIG9mIHRoZSBjdXJyZW50XHJcbiAgICAgKiBzY3JlZW4uXHJcbiAgICAgKiBAcmV0dXJucyBhIHtQaGFzZXIuTWF0aC5WZWN0b3IyfSBjbG9uZSBvZiB0aGUgcG9zaXRpb25cclxuICAgICAqL1xyXG4gICAgZ2V0UG9zaXRpb24oKTogUGhhc2VyLk1hdGguVmVjdG9yMiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYG1vdXNlIGxvY2F0aW9uOiAke0pTT04uc3RyaW5naWZ5KHRoaXMubG9jYXRpb24pfWApO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvY2F0aW9uLmNsb25lKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBvZmZzZXRzIHRoZSBzY3JlZW4gcG9zaXRpb24gYmFzZWQgb24gY2FtZXJhIHBvc2l0aW9uXHJcbiAgICAgKi9cclxuICAgIGdldFJlYWxQb3NpdGlvbigpOiBQaGFzZXIuTWF0aC5WZWN0b3IyIHtcclxuICAgICAgICBsZXQgd29ybGQ6IFBoYXNlci5NYXRoLlZlY3RvcjIgPSB0aGlzLnNjZW5lLmNhbWVyYXMubWFpbi5nZXRXb3JsZFBvaW50KHRoaXMubG9jYXRpb24ueCwgdGhpcy5sb2NhdGlvbi55KTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgbW91c2UgUkVBTCBsb2NhdGlvbjogJHtKU09OLnN0cmluZ2lmeSh3b3JsZCl9YCk7XHJcbiAgICAgICAgcmV0dXJuIHdvcmxkO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgU2hpcFBvZCB9IGZyb20gXCIuLi9zaGlwcy9zaGlwLXBvZFwiO1xyXG5cclxuZXhwb3J0IG1vZHVsZSBHbG9iYWxzIHtcclxuICAgIGV4cG9ydCB2YXIgaXNQYXVzZWQ6IGJvb2xlYW47XHJcbiAgICBleHBvcnQgdmFyIHBsYXllcjogU2hpcFBvZDtcclxufSJdLCJzb3VyY2VSb290IjoiIn0=