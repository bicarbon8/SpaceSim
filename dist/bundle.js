!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("phaser")):"function"==typeof define&&define.amd?define(["phaser"],t):"object"==typeof exports?exports.bundle=t(require("phaser")):e.bundle=t(e.phaser)}(window,(function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Globals||(t.Globals={})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o={type:Phaser.AUTO,scale:{width:window.innerWidth,height:window.innerHeight},backgroundColor:"#000000",parent:"space-sim",physics:{default:"arcade",arcade:{gravity:{x:0,y:0}}},scene:r.GameScene};t.game=new Phaser.Game(o),window.addEventListener("resize",(function(){t.game.scale.refresh()}))},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),s=n(2),a={active:!0,visible:!0,key:"GameScene"},u=function(e){function t(){return e.call(this,a)||this}return o(t,e),t.prototype.preload=function(){},t.prototype.create=function(){s.Globals.inputKeys=this.input.keyboard.createCursorKeys();var e={scene:this,x:200,y:200,texture:"./assets/sprites/ship-pod.png",frame:0};s.Globals.player=new i.ShipPod(e),this.input.on("pointermove",(function(e){console.log("mouse: "+e.x+", "+e.y),s.Globals.mouseLocation=new Phaser.Math.Vector2(e.x,e.y)})),this.input.on("KEY_DOWN_P",(function(e){s.Globals.isPaused=!0})),this.input.on("KEY_DOWN_R",(function(){s.Globals.isPaused=!1}))},t.prototype.update=function(){s.Globals.isPaused||s.Globals.player.update()},t}(Phaser.Scene);t.GameScene=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);n(10);var o=n(2),i=function(){function e(e){this.active=!0,this.fuelCapacity=100,this.remainingFuel=100,this.thrusterForce=1,this.thrusterFuelConsumption=.01,this.thrusterHeatGeneration=.5,this.rotationRate=.2,this.integrity=100,this.temperature=0,this.realPosition=Phaser.Math.Vector2.ZERO,this.config=e,this.id=r.RNG.guid(),this.gameObj=this.config.scene.physics.add.sprite(this.config.scene.game.scale.width/2,this.config.scene.game.scale.height/2,"ship-pod")}return e.prototype.update=function(){this.lookAt(o.Globals.mouseLocation),o.Globals.inputKeys.space.isDown&&this.activateThruster(),this.applyCooling(),this.integrityCheck()},e.prototype.getId=function(){return this.id},e.prototype.lookAt=function(e){if(e){var t=Phaser.Math.Angle.Between(e.x,e.y,this.gameObj.x,this.gameObj.y);this.gameObj.setRotation(t)}},e.prototype.activateThruster=function(){if(this.remainingFuel>0){var e=o.Globals.mouseLocation.clone().subtract(new Phaser.Math.Vector2(this.gameObj.x,this.gameObj.y)).clone().normalize().clone().multiply(new Phaser.Math.Vector2(this.thrusterForce,this.thrusterForce)),t=this.gameObj.body.velocity;console.log("current velocity: "+JSON.stringify(t));var n=t.add(e);this.gameObj.setVelocity(n.x,n.y),this.remainingFuel-=this.thrusterFuelConsumption,this.applyHeating(this.thrusterHeatGeneration)}},e.prototype.applyHeating=function(e){if(this.temperature+=e,this.temperature>100){var t=this.temperature-100;this.integrity-=t}},e.prototype.applyCooling=function(){this.temperature>0&&(this.temperature-=.1),this.temperature<0&&(this.temperature=0)},e.prototype.integrityCheck=function(){this.integrity<=0&&(this.active=!1)},e}();t.ShipPod=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7);!function(e){e.int=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},e.guid=function(){return r.v4()}}(t.RNG||(t.RNG={}))},function(e,t,n){var r=n(8),o=n(9),i=o;i.v1=r,i.v4=o,e.exports=i},function(e,t,n){var r,o,i=n(0),s=n(1),a=0,u=0;e.exports=function(e,t,n){var c=t&&n||0,p=t||[],l=(e=e||{}).node||r,f=void 0!==e.clockseq?e.clockseq:o;if(null==l||null==f){var h=i();null==l&&(l=r=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==f&&(f=o=16383&(h[6]<<8|h[7]))}var d=void 0!==e.msecs?e.msecs:(new Date).getTime(),y=void 0!==e.nsecs?e.nsecs:u+1,v=d-a+(y-u)/1e4;if(v<0&&void 0===e.clockseq&&(f=f+1&16383),(v<0||d>a)&&void 0===e.nsecs&&(y=0),y>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=d,u=y,o=f;var m=(1e4*(268435455&(d+=122192928e5))+y)%4294967296;p[c++]=m>>>24&255,p[c++]=m>>>16&255,p[c++]=m>>>8&255,p[c++]=255&m;var g=d/4294967296*1e4&268435455;p[c++]=g>>>8&255,p[c++]=255&g,p[c++]=g>>>24&15|16,p[c++]=g>>>16&255,p[c++]=f>>>8|128,p[c++]=255&f;for(var b=0;b<6;++b)p[c+b]=l[b];return t||s(p)}},function(e,t,n){var r=n(0),o=n(1);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[i+a]=s[a];return t||o(s)}},function(t,n){t.exports=e}])}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9idW5kbGUvd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL2J1bmRsZS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9idW5kbGUvLi9ub2RlX21vZHVsZXMvdXVpZC9saWIvcm5nLWJyb3dzZXIuanMiLCJ3ZWJwYWNrOi8vYnVuZGxlLy4vbm9kZV9tb2R1bGVzL3V1aWQvbGliL2J5dGVzVG9VdWlkLmpzIiwid2VicGFjazovL2J1bmRsZS8uL3NyYy91dGlsaXRpZXMvZ2xvYmFscy50cyIsIndlYnBhY2s6Ly9idW5kbGUvLi9zcmMvZ2FtZS50cyIsIndlYnBhY2s6Ly9idW5kbGUvLi9zcmMvZ2FtZS1zY2VuZS50cyIsIndlYnBhY2s6Ly9idW5kbGUvLi9zcmMvc2hpcHMvc2hpcC1wb2QudHMiLCJ3ZWJwYWNrOi8vYnVuZGxlLy4vc3JjL3V0aWxpdGllcy9ybmcudHMiLCJ3ZWJwYWNrOi8vYnVuZGxlLy4vbm9kZV9tb2R1bGVzL3V1aWQvaW5kZXguanMiLCJ3ZWJwYWNrOi8vYnVuZGxlLy4vbm9kZV9tb2R1bGVzL3V1aWQvdjEuanMiLCJ3ZWJwYWNrOi8vYnVuZGxlLy4vbm9kZV9tb2R1bGVzL3V1aWQvdjQuanMiLCJ3ZWJwYWNrOi8vYnVuZGxlL2V4dGVybmFsIFwicGhhc2VyXCIiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwicmVxdWlyZSIsImRlZmluZSIsImFtZCIsIndpbmRvdyIsIl9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzEwX18iLCJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiZ2V0UmFuZG9tVmFsdWVzIiwiY3J5cHRvIiwibXNDcnlwdG8iLCJybmRzOCIsIlVpbnQ4QXJyYXkiLCJybmRzIiwiQXJyYXkiLCJNYXRoIiwicmFuZG9tIiwiYnl0ZVRvSGV4IiwidG9TdHJpbmciLCJzdWJzdHIiLCJidWYiLCJvZmZzZXQiLCJidGgiLCJqb2luIiwiR2xvYmFscyIsImdhbWVDb25maWciLCJ0eXBlIiwiUGhhc2VyIiwiQVVUTyIsInNjYWxlIiwid2lkdGgiLCJpbm5lcldpZHRoIiwiaGVpZ2h0IiwiaW5uZXJIZWlnaHQiLCJiYWNrZ3JvdW5kQ29sb3IiLCJwYXJlbnQiLCJwaHlzaWNzIiwiZGVmYXVsdCIsImFyY2FkZSIsImdyYXZpdHkiLCJ4IiwieSIsInNjZW5lIiwiR2FtZVNjZW5lIiwiZ2FtZSIsIkdhbWUiLCJhZGRFdmVudExpc3RlbmVyIiwicmVmcmVzaCIsInNjZW5lQ29uZmlnIiwiYWN0aXZlIiwidmlzaWJsZSIsInByZWxvYWQiLCJpbnB1dEtleXMiLCJ0aGlzIiwiaW5wdXQiLCJrZXlib2FyZCIsImNyZWF0ZUN1cnNvcktleXMiLCJwb2RDb25maWciLCJ0ZXh0dXJlIiwiZnJhbWUiLCJwbGF5ZXIiLCJTaGlwUG9kIiwib24iLCJwb2ludGVyIiwiY29uc29sZSIsImxvZyIsIm1vdXNlTG9jYXRpb24iLCJWZWN0b3IyIiwiZXZlbnQiLCJpc1BhdXNlZCIsInVwZGF0ZSIsIlNjZW5lIiwiY29uZmlnIiwiZnVlbENhcGFjaXR5IiwicmVtYWluaW5nRnVlbCIsInRocnVzdGVyRm9yY2UiLCJ0aHJ1c3RlckZ1ZWxDb25zdW1wdGlvbiIsInRocnVzdGVySGVhdEdlbmVyYXRpb24iLCJyb3RhdGlvblJhdGUiLCJpbnRlZ3JpdHkiLCJ0ZW1wZXJhdHVyZSIsInJlYWxQb3NpdGlvbiIsIlpFUk8iLCJpZCIsIlJORyIsImd1aWQiLCJnYW1lT2JqIiwiYWRkIiwic3ByaXRlIiwibG9va0F0Iiwic3BhY2UiLCJpc0Rvd24iLCJhY3RpdmF0ZVRocnVzdGVyIiwiYXBwbHlDb29saW5nIiwiaW50ZWdyaXR5Q2hlY2siLCJnZXRJZCIsInBvc2l0aW9uIiwicmFkaWFucyIsIkFuZ2xlIiwiQmV0d2VlbiIsInNldFJvdGF0aW9uIiwiZm9yY2UiLCJjbG9uZSIsInN1YnRyYWN0Iiwibm9ybWFsaXplIiwibXVsdGlwbHkiLCJ2IiwiYm9keSIsInZlbG9jaXR5IiwiSlNPTiIsInN0cmluZ2lmeSIsInNldFZlbG9jaXR5IiwiYXBwbHlIZWF0aW5nIiwiZGVncmVlcyIsImRlbHRhIiwiaW50IiwibWluIiwibWF4IiwiZmxvb3IiLCJ2NCIsInYxIiwidXVpZCIsIl9ub2RlSWQiLCJfY2xvY2tzZXEiLCJybmciLCJieXRlc1RvVXVpZCIsIl9sYXN0TVNlY3MiLCJfbGFzdE5TZWNzIiwib3B0aW9ucyIsImIiLCJub2RlIiwiY2xvY2tzZXEiLCJ1bmRlZmluZWQiLCJzZWVkQnl0ZXMiLCJtc2VjcyIsIkRhdGUiLCJnZXRUaW1lIiwibnNlY3MiLCJkdCIsIkVycm9yIiwidGwiLCJ0bWgiLCJpaSJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBMkNBLEVBQU1DLEdBQzFCLGlCQUFaQyxTQUEwQyxpQkFBWEMsT0FDeENBLE9BQU9ELFFBQVVELEVBQVFHLFFBQVEsV0FDUixtQkFBWEMsUUFBeUJBLE9BQU9DLElBQzlDRCxPQUFPLENBQUMsVUFBV0osR0FDTyxpQkFBWkMsUUFDZEEsUUFBZ0IsT0FBSUQsRUFBUUcsUUFBUSxXQUVwQ0osRUFBYSxPQUFJQyxFQUFRRCxFQUFhLFFBUnhDLENBU0dPLFFBQVEsU0FBU0MsR0FDcEIsTyxZQ1RFLElBQUlDLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVULFFBR25DLElBQUlDLEVB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QUNSRCxFQUFrQixXQUFaNEcsRUFBdUIsSUFBSWxILE1BQU0sSUFBTSxLQUM3Q2tILEVBQVUsTUFJWixJQUFJbkgsR0FGSm1ILEVBQVVBLEdBQVcsSUFFRmhILFNBQVdnSCxFQUFRSixLQUFPQSxLQU83QyxHQUpBL0csRUFBSyxHQUFnQixHQUFWQSxFQUFLLEdBQWEsR0FDN0JBLEVBQUssR0FBZ0IsR0FBVkEsRUFBSyxHQUFhLElBR3pCTyxFQUNGLElBQUssSUFBSTBILEVBQUssRUFBR0EsRUFBSyxLQUFNQSxFQUMxQjFILEVBQUk1QyxFQUFJc0ssR0FBTWpJLEVBQUtpSSxHQUl2QixPQUFPMUgsR0FBT3lHLEVBQVloSCxLLGNDekI1QjlDLEVBQU9ELFFBQVVNIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZShcInBoYXNlclwiKSk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXCJwaGFzZXJcIl0sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiYnVuZGxlXCJdID0gZmFjdG9yeShyZXF1aXJlKFwicGhhc2VyXCIpKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJidW5kbGVcIl0gPSBmYWN0b3J5KHJvb3RbXCJwaGFzZXJcIl0pO1xufSkod2luZG93LCBmdW5jdGlvbihfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18xMF9fKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDMpO1xuIiwiLy8gVW5pcXVlIElEIGNyZWF0aW9uIHJlcXVpcmVzIGEgaGlnaCBxdWFsaXR5IHJhbmRvbSAjIGdlbmVyYXRvci4gIEluIHRoZVxuLy8gYnJvd3NlciB0aGlzIGlzIGEgbGl0dGxlIGNvbXBsaWNhdGVkIGR1ZSB0byB1bmtub3duIHF1YWxpdHkgb2YgTWF0aC5yYW5kb20oKVxuLy8gYW5kIGluY29uc2lzdGVudCBzdXBwb3J0IGZvciB0aGUgYGNyeXB0b2AgQVBJLiAgV2UgZG8gdGhlIGJlc3Qgd2UgY2FuIHZpYVxuLy8gZmVhdHVyZS1kZXRlY3Rpb25cblxuLy8gZ2V0UmFuZG9tVmFsdWVzIG5lZWRzIHRvIGJlIGludm9rZWQgaW4gYSBjb250ZXh0IHdoZXJlIFwidGhpc1wiIGlzIGEgQ3J5cHRvXG4vLyBpbXBsZW1lbnRhdGlvbi4gQWxzbywgZmluZCB0aGUgY29tcGxldGUgaW1wbGVtZW50YXRpb24gb2YgY3J5cHRvIG9uIElFMTEuXG52YXIgZ2V0UmFuZG9tVmFsdWVzID0gKHR5cGVvZihjcnlwdG8pICE9ICd1bmRlZmluZWQnICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMgJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKGNyeXB0bykpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgKHR5cGVvZihtc0NyeXB0bykgIT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHdpbmRvdy5tc0NyeXB0by5nZXRSYW5kb21WYWx1ZXMgPT0gJ2Z1bmN0aW9uJyAmJiBtc0NyeXB0by5nZXRSYW5kb21WYWx1ZXMuYmluZChtc0NyeXB0bykpO1xuXG5pZiAoZ2V0UmFuZG9tVmFsdWVzKSB7XG4gIC8vIFdIQVRXRyBjcnlwdG8gUk5HIC0gaHR0cDovL3dpa2kud2hhdHdnLm9yZy93aWtpL0NyeXB0b1xuICB2YXIgcm5kczggPSBuZXcgVWludDhBcnJheSgxNik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW5kZWZcblxuICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHdoYXR3Z1JORygpIHtcbiAgICBnZXRSYW5kb21WYWx1ZXMocm5kczgpO1xuICAgIHJldHVybiBybmRzODtcbiAgfTtcbn0gZWxzZSB7XG4gIC8vIE1hdGgucmFuZG9tKCktYmFzZWQgKFJORylcbiAgLy9cbiAgLy8gSWYgYWxsIGVsc2UgZmFpbHMsIHVzZSBNYXRoLnJhbmRvbSgpLiAgSXQncyBmYXN0LCBidXQgaXMgb2YgdW5zcGVjaWZpZWRcbiAgLy8gcXVhbGl0eS5cbiAgdmFyIHJuZHMgPSBuZXcgQXJyYXkoMTYpO1xuXG4gIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gbWF0aFJORygpIHtcbiAgICBmb3IgKHZhciBpID0gMCwgcjsgaSA8IDE2OyBpKyspIHtcbiAgICAgIGlmICgoaSAmIDB4MDMpID09PSAwKSByID0gTWF0aC5yYW5kb20oKSAqIDB4MTAwMDAwMDAwO1xuICAgICAgcm5kc1tpXSA9IHIgPj4+ICgoaSAmIDB4MDMpIDw8IDMpICYgMHhmZjtcbiAgICB9XG5cbiAgICByZXR1cm4gcm5kcztcbiAgfTtcbn1cbiIsIi8qKlxuICogQ29udmVydCBhcnJheSBvZiAxNiBieXRlIHZhbHVlcyB0byBVVUlEIHN0cmluZyBmb3JtYXQgb2YgdGhlIGZvcm06XG4gKiBYWFhYWFhYWC1YWFhYLVhYWFgtWFhYWC1YWFhYWFhYWFhYWFhcbiAqL1xudmFyIGJ5dGVUb0hleCA9IFtdO1xuZm9yICh2YXIgaSA9IDA7IGkgPCAyNTY7ICsraSkge1xuICBieXRlVG9IZXhbaV0gPSAoaSArIDB4MTAwKS50b1N0cmluZygxNikuc3Vic3RyKDEpO1xufVxuXG5mdW5jdGlvbiBieXRlc1RvVXVpZChidWYsIG9mZnNldCkge1xuICB2YXIgaSA9IG9mZnNldCB8fCAwO1xuICB2YXIgYnRoID0gYnl0ZVRvSGV4O1xuICAvLyBqb2luIHVzZWQgdG8gZml4IG1lbW9yeSBpc3N1ZSBjYXVzZWQgYnkgY29uY2F0ZW5hdGlvbjogaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL3Y4L2lzc3Vlcy9kZXRhaWw/aWQ9MzE3NSNjNFxuICByZXR1cm4gKFtcbiAgICBidGhbYnVmW2krK11dLCBidGhbYnVmW2krK11dLFxuICAgIGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV0sICctJyxcbiAgICBidGhbYnVmW2krK11dLCBidGhbYnVmW2krK11dLCAnLScsXG4gICAgYnRoW2J1ZltpKytdXSwgYnRoW2J1ZltpKytdXSwgJy0nLFxuICAgIGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV0sICctJyxcbiAgICBidGhbYnVmW2krK11dLCBidGhbYnVmW2krK11dLFxuICAgIGJ0aFtidWZbaSsrXV0sIGJ0aFtidWZbaSsrXV0sXG4gICAgYnRoW2J1ZltpKytdXSwgYnRoW2J1ZltpKytdXVxuICBdKS5qb2luKCcnKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBieXRlc1RvVXVpZDtcbiIsImltcG9ydCB7IFNoaXBQb2QgfSBmcm9tIFwiLi4vc2hpcHMvc2hpcC1wb2RcIjtcclxuXHJcbmV4cG9ydCBtb2R1bGUgR2xvYmFscyB7XHJcbiAgICBleHBvcnQgdmFyIGlucHV0S2V5czogUGhhc2VyLlR5cGVzLklucHV0LktleWJvYXJkLkN1cnNvcktleXM7XHJcbiAgICBleHBvcnQgdmFyIG1vdXNlTG9jYXRpb246IFBoYXNlci5NYXRoLlZlY3RvcjI7XHJcbiAgICBleHBvcnQgdmFyIGlzUGF1c2VkOiBib29sZWFuO1xyXG4gICAgZXhwb3J0IHZhciBwbGF5ZXI6IFNoaXBQb2Q7XHJcbn0iLCJpbXBvcnQgeyBHYW1lU2NlbmUgfSBmcm9tIFwiLi9nYW1lLXNjZW5lXCI7XHJcblxyXG5jb25zdCBnYW1lQ29uZmlnOiBQaGFzZXIuVHlwZXMuQ29yZS5HYW1lQ29uZmlnID0ge1xyXG4gICAgdHlwZTogUGhhc2VyLkFVVE8sXHJcbiAgICBzY2FsZToge1xyXG4gICAgICAgIHdpZHRoOiB3aW5kb3cuaW5uZXJXaWR0aCxcclxuICAgICAgICBoZWlnaHQ6IHdpbmRvdy5pbm5lckhlaWdodFxyXG4gICAgfSxcclxuICAgIGJhY2tncm91bmRDb2xvcjogJyMwMDAwMDAnLFxyXG4gICAgcGFyZW50OiAnc3BhY2Utc2ltJyxcclxuICAgIHBoeXNpY3M6IHtcclxuICAgICAgICBkZWZhdWx0OiAnYXJjYWRlJyxcclxuICAgICAgICBhcmNhZGU6IHtcclxuICAgICAgICAgICAgZ3Jhdml0eTogeyB4OiAwLCB5OiAwIH0sXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHNjZW5lOiBHYW1lU2NlbmVcclxufTtcclxuZXhwb3J0IGNvbnN0IGdhbWU6IFBoYXNlci5HYW1lID0gbmV3IFBoYXNlci5HYW1lKGdhbWVDb25maWcpO1xyXG5cclxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsICgpID0+IHtcclxuICAgIGdhbWUuc2NhbGUucmVmcmVzaCgpO1xyXG59KSIsImltcG9ydCB7IFNoaXBQb2QgfSBmcm9tIFwiLi9zaGlwcy9zaGlwLXBvZFwiO1xyXG5pbXBvcnQgeyBTaGlwUG9kQ29uZmlnIH0gZnJvbSBcIi4vc2hpcHMvc2hpcC1wb2QtY29uZmlnXCI7XHJcbmltcG9ydCB7IEdsb2JhbHMgfSBmcm9tIFwiLi91dGlsaXRpZXMvZ2xvYmFsc1wiO1xyXG5cclxuY29uc3Qgc2NlbmVDb25maWc6IFBoYXNlci5UeXBlcy5TY2VuZXMuU2V0dGluZ3NDb25maWcgPSB7XHJcbiAgICBhY3RpdmU6IHRydWUsXHJcbiAgICB2aXNpYmxlOiB0cnVlLFxyXG4gICAga2V5OiAnR2FtZVNjZW5lJ1xyXG59O1xyXG5cclxuZXhwb3J0IGNsYXNzIEdhbWVTY2VuZSBleHRlbmRzIFBoYXNlci5TY2VuZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcihzY2VuZUNvbmZpZyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHByZWxvYWQoKTogdm9pZCB7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNyZWF0ZSgpOiB2b2lkIHtcclxuICAgICAgICBHbG9iYWxzLmlucHV0S2V5cyA9IHRoaXMuaW5wdXQua2V5Ym9hcmQuY3JlYXRlQ3Vyc29yS2V5cygpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBwb2RDb25maWc6IFNoaXBQb2RDb25maWcgPSB7XHJcbiAgICAgICAgICAgIHNjZW5lOiB0aGlzLFxyXG4gICAgICAgICAgICB4OiAyMDAsXHJcbiAgICAgICAgICAgIHk6IDIwMCxcclxuICAgICAgICAgICAgdGV4dHVyZTogJy4vYXNzZXRzL3Nwcml0ZXMvc2hpcC1wb2QucG5nJyxcclxuICAgICAgICAgICAgZnJhbWU6IDBcclxuICAgICAgICB9O1xyXG4gICAgICAgIEdsb2JhbHMucGxheWVyID0gbmV3IFNoaXBQb2QocG9kQ29uZmlnKTtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLmlucHV0Lm9uKCdwb2ludGVybW92ZScsIChwb2ludGVyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBtb3VzZTogJHtwb2ludGVyLnh9LCAke3BvaW50ZXIueX1gKTtcclxuICAgICAgICAgICAgR2xvYmFscy5tb3VzZUxvY2F0aW9uID0gbmV3IFBoYXNlci5NYXRoLlZlY3RvcjIocG9pbnRlci54LCBwb2ludGVyLnkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuaW5wdXQub24oJ0tFWV9ET1dOX1AnLCAoZXZlbnQpID0+IHtcclxuICAgICAgICAgICAgR2xvYmFscy5pc1BhdXNlZCA9IHRydWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5pbnB1dC5vbignS0VZX0RPV05fUicsICgpID0+IHtcclxuICAgICAgICAgICAgR2xvYmFscy5pc1BhdXNlZCA9IGZhbHNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyB1cGRhdGUoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKCFHbG9iYWxzLmlzUGF1c2VkKSB7XHJcbiAgICAgICAgICAgIEdsb2JhbHMucGxheWVyLnVwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsImltcG9ydCB7IFJORyB9IGZyb20gXCIuLi91dGlsaXRpZXMvcm5nXCI7XHJcbmltcG9ydCBcInBoYXNlclwiO1xyXG5pbXBvcnQgeyBTaGlwUG9kQ29uZmlnIH0gZnJvbSBcIi4vc2hpcC1wb2QtY29uZmlnXCI7XHJcbmltcG9ydCB7IEdsb2JhbHMgfSBmcm9tIFwiLi4vdXRpbGl0aWVzL2dsb2JhbHNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBTaGlwUG9kIHtcclxuICAgIHByaXZhdGUgaWQ6IHN0cmluZzsgLy8gVVVJRFxyXG4gICAgcHJpdmF0ZSBjb25maWc6IFNoaXBQb2RDb25maWc7XHJcbiAgICBwcml2YXRlIGdhbWVPYmo6IFBoYXNlci5QaHlzaWNzLkFyY2FkZS5TcHJpdGU7XHJcblxyXG4gICAgYWN0aXZlOiBib29sZWFuID0gdHJ1ZTtcclxuICAgIFxyXG4gICAgZnVlbENhcGFjaXR5OiBudW1iZXIgPSAxMDA7XHJcbiAgICByZW1haW5pbmdGdWVsOiBudW1iZXIgPSAxMDA7XHJcbiAgICBcclxuICAgIHRocnVzdGVyRm9yY2U6IG51bWJlciA9IDE7IC8vIEtpbG9OZXd0b25zXHJcbiAgICB0aHJ1c3RlckZ1ZWxDb25zdW1wdGlvbjogbnVtYmVyID0gMC4wMTtcclxuICAgIHRocnVzdGVySGVhdEdlbmVyYXRpb246IG51bWJlciA9IDAuNTtcclxuXHJcbiAgICByb3RhdGlvblJhdGU6IG51bWJlciA9IDAuMjsgLy8gZGVncmVlcyBwZXIgc2Vjb25kXHJcbiAgICBpbnRlZ3JpdHk6IG51bWJlciA9IDEwMDsgLy8gbWF4aW11bSBvZiAxMDBcclxuICAgIHRlbXBlcmF0dXJlOiBudW1iZXIgPSAwOyAvLyBpbiBDZWxjaXVzXHJcblxyXG4gICAgcmVhbFBvc2l0aW9uOiBQaGFzZXIuTWF0aC5WZWN0b3IyID0gUGhhc2VyLk1hdGguVmVjdG9yMi5aRVJPOyAvLyBuZWVkZWQgc28gd2UgY2FuIHVzZSBGbG9hdGluZyBPcmlnaW5cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihjb25maWc6IFNoaXBQb2RDb25maWcpIHtcclxuICAgICAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZztcclxuICAgICAgICB0aGlzLmlkID0gUk5HLmd1aWQoKTtcclxuXHJcbiAgICAgICAgdGhpcy5nYW1lT2JqID0gdGhpcy5jb25maWcuc2NlbmUucGh5c2ljcy5hZGQuc3ByaXRlKHRoaXMuY29uZmlnLnNjZW5lLmdhbWUuc2NhbGUud2lkdGggLyAyLCB0aGlzLmNvbmZpZy5zY2VuZS5nYW1lLnNjYWxlLmhlaWdodCAvIDIsICdzaGlwLXBvZCcpO1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmxvb2tBdChHbG9iYWxzLm1vdXNlTG9jYXRpb24pO1xyXG4gICAgICAgIGlmIChHbG9iYWxzLmlucHV0S2V5cy5zcGFjZS5pc0Rvd24pIHtcclxuICAgICAgICAgICAgdGhpcy5hY3RpdmF0ZVRocnVzdGVyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuYXBwbHlDb29saW5nKCk7XHJcbiAgICAgICAgdGhpcy5pbnRlZ3JpdHlDaGVjaygpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldElkKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaWQ7XHJcbiAgICB9XHJcblxyXG4gICAgbG9va0F0KHBvc2l0aW9uOiBQaGFzZXIuTWF0aC5WZWN0b3IyKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHBvc2l0aW9uKSB7XHJcbiAgICAgICAgICAgIGxldCByYWRpYW5zOiBudW1iZXIgPSBQaGFzZXIuTWF0aC5BbmdsZS5CZXR3ZWVuKHBvc2l0aW9uLngsIHBvc2l0aW9uLnksIHRoaXMuZ2FtZU9iai54LCB0aGlzLmdhbWVPYmoueSk7XHJcbiAgICAgICAgICAgIHRoaXMuZ2FtZU9iai5zZXRSb3RhdGlvbihyYWRpYW5zKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYWN0aXZhdGVUaHJ1c3RlcigpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5yZW1haW5pbmdGdWVsID4gMCkge1xyXG4gICAgICAgICAgICBsZXQgZGVsdGE6IFBoYXNlci5NYXRoLlZlY3RvcjIgPSBHbG9iYWxzLm1vdXNlTG9jYXRpb24uY2xvbmUoKS5zdWJ0cmFjdChuZXcgUGhhc2VyLk1hdGguVmVjdG9yMih0aGlzLmdhbWVPYmoueCwgdGhpcy5nYW1lT2JqLnkpKTtcclxuICAgICAgICAgICAgbGV0IG5vcm1hbGlzZWREZWx0YTogUGhhc2VyLk1hdGguVmVjdG9yMiA9IGRlbHRhLmNsb25lKCkubm9ybWFsaXplKCk7XHJcbiAgICAgICAgICAgIGxldCBmb3JjZTogUGhhc2VyLk1hdGguVmVjdG9yMiA9IG5vcm1hbGlzZWREZWx0YS5jbG9uZSgpLm11bHRpcGx5KG5ldyBQaGFzZXIuTWF0aC5WZWN0b3IyKHRoaXMudGhydXN0ZXJGb3JjZSwgdGhpcy50aHJ1c3RlckZvcmNlKSk7XHJcbiAgICAgICAgICAgIGxldCB2ID0gdGhpcy5nYW1lT2JqLmJvZHkudmVsb2NpdHk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBjdXJyZW50IHZlbG9jaXR5OiAke0pTT04uc3RyaW5naWZ5KHYpfWApO1xyXG4gICAgICAgICAgICBsZXQgdmVsb2NpdHkgPSB2LmFkZChmb3JjZSk7XHJcbiAgICAgICAgICAgIHRoaXMuZ2FtZU9iai5zZXRWZWxvY2l0eSh2ZWxvY2l0eS54LCB2ZWxvY2l0eS55KTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucmVtYWluaW5nRnVlbCAtPSB0aGlzLnRocnVzdGVyRnVlbENvbnN1bXB0aW9uO1xyXG4gICAgICAgICAgICB0aGlzLmFwcGx5SGVhdGluZyh0aGlzLnRocnVzdGVySGVhdEdlbmVyYXRpb24pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhcHBseUhlYXRpbmcoZGVncmVlczogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy50ZW1wZXJhdHVyZSArPSBkZWdyZWVzO1xyXG4gICAgICAgIGlmICh0aGlzLnRlbXBlcmF0dXJlID4gMTAwKSB7XHJcbiAgICAgICAgICAgIC8vIHJlZHVjZSBpbnRlZ3JpdHkgYmFzZWQgb24gZGVncmVlcyBvdmVyIDEwMFxyXG4gICAgICAgICAgICBsZXQgZGVsdGE6IG51bWJlciA9IHRoaXMudGVtcGVyYXR1cmUgLSAxMDA7XHJcbiAgICAgICAgICAgIHRoaXMuaW50ZWdyaXR5IC09IGRlbHRhO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhcHBseUNvb2xpbmcoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMudGVtcGVyYXR1cmUgPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGVtcGVyYXR1cmUgLT0gMC4xO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy50ZW1wZXJhdHVyZSA8IDApIHtcclxuICAgICAgICAgICAgdGhpcy50ZW1wZXJhdHVyZSA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGludGVncml0eUNoZWNrKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmludGVncml0eSA8PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IGRlc3Ryb3kgc2hpcCBhbmQgZW5kIGdhbWVcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyB2NCB9IGZyb20gXCJ1dWlkXCI7XHJcblxyXG5leHBvcnQgbW9kdWxlIFJORyB7XHJcbiAgICBleHBvcnQgZnVuY3Rpb24gaW50KG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSkgKyBtaW47XHJcbiAgICB9XHJcblxyXG4gICAgZXhwb3J0IGZ1bmN0aW9uIGd1aWQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdjQoKTtcclxuICAgIH1cclxufSIsInZhciB2MSA9IHJlcXVpcmUoJy4vdjEnKTtcbnZhciB2NCA9IHJlcXVpcmUoJy4vdjQnKTtcblxudmFyIHV1aWQgPSB2NDtcbnV1aWQudjEgPSB2MTtcbnV1aWQudjQgPSB2NDtcblxubW9kdWxlLmV4cG9ydHMgPSB1dWlkO1xuIiwidmFyIHJuZyA9IHJlcXVpcmUoJy4vbGliL3JuZycpO1xudmFyIGJ5dGVzVG9VdWlkID0gcmVxdWlyZSgnLi9saWIvYnl0ZXNUb1V1aWQnKTtcblxuLy8gKipgdjEoKWAgLSBHZW5lcmF0ZSB0aW1lLWJhc2VkIFVVSUQqKlxuLy9cbi8vIEluc3BpcmVkIGJ5IGh0dHBzOi8vZ2l0aHViLmNvbS9MaW9zSy9VVUlELmpzXG4vLyBhbmQgaHR0cDovL2RvY3MucHl0aG9uLm9yZy9saWJyYXJ5L3V1aWQuaHRtbFxuXG52YXIgX25vZGVJZDtcbnZhciBfY2xvY2tzZXE7XG5cbi8vIFByZXZpb3VzIHV1aWQgY3JlYXRpb24gdGltZVxudmFyIF9sYXN0TVNlY3MgPSAwO1xudmFyIF9sYXN0TlNlY3MgPSAwO1xuXG4vLyBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkIGZvciBBUEkgZGV0YWlsc1xuZnVuY3Rpb24gdjEob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgdmFyIGkgPSBidWYgJiYgb2Zmc2V0IHx8IDA7XG4gIHZhciBiID0gYnVmIHx8IFtdO1xuXG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICB2YXIgbm9kZSA9IG9wdGlvbnMubm9kZSB8fCBfbm9kZUlkO1xuICB2YXIgY2xvY2tzZXEgPSBvcHRpb25zLmNsb2Nrc2VxICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmNsb2Nrc2VxIDogX2Nsb2Nrc2VxO1xuXG4gIC8vIG5vZGUgYW5kIGNsb2Nrc2VxIG5lZWQgdG8gYmUgaW5pdGlhbGl6ZWQgdG8gcmFuZG9tIHZhbHVlcyBpZiB0aGV5J3JlIG5vdFxuICAvLyBzcGVjaWZpZWQuICBXZSBkbyB0aGlzIGxhemlseSB0byBtaW5pbWl6ZSBpc3N1ZXMgcmVsYXRlZCB0byBpbnN1ZmZpY2llbnRcbiAgLy8gc3lzdGVtIGVudHJvcHkuICBTZWUgIzE4OVxuICBpZiAobm9kZSA9PSBudWxsIHx8IGNsb2Nrc2VxID09IG51bGwpIHtcbiAgICB2YXIgc2VlZEJ5dGVzID0gcm5nKCk7XG4gICAgaWYgKG5vZGUgPT0gbnVsbCkge1xuICAgICAgLy8gUGVyIDQuNSwgY3JlYXRlIGFuZCA0OC1iaXQgbm9kZSBpZCwgKDQ3IHJhbmRvbSBiaXRzICsgbXVsdGljYXN0IGJpdCA9IDEpXG4gICAgICBub2RlID0gX25vZGVJZCA9IFtcbiAgICAgICAgc2VlZEJ5dGVzWzBdIHwgMHgwMSxcbiAgICAgICAgc2VlZEJ5dGVzWzFdLCBzZWVkQnl0ZXNbMl0sIHNlZWRCeXRlc1szXSwgc2VlZEJ5dGVzWzRdLCBzZWVkQnl0ZXNbNV1cbiAgICAgIF07XG4gICAgfVxuICAgIGlmIChjbG9ja3NlcSA9PSBudWxsKSB7XG4gICAgICAvLyBQZXIgNC4yLjIsIHJhbmRvbWl6ZSAoMTQgYml0KSBjbG9ja3NlcVxuICAgICAgY2xvY2tzZXEgPSBfY2xvY2tzZXEgPSAoc2VlZEJ5dGVzWzZdIDw8IDggfCBzZWVkQnl0ZXNbN10pICYgMHgzZmZmO1xuICAgIH1cbiAgfVxuXG4gIC8vIFVVSUQgdGltZXN0YW1wcyBhcmUgMTAwIG5hbm8tc2Vjb25kIHVuaXRzIHNpbmNlIHRoZSBHcmVnb3JpYW4gZXBvY2gsXG4gIC8vICgxNTgyLTEwLTE1IDAwOjAwKS4gIEpTTnVtYmVycyBhcmVuJ3QgcHJlY2lzZSBlbm91Z2ggZm9yIHRoaXMsIHNvXG4gIC8vIHRpbWUgaXMgaGFuZGxlZCBpbnRlcm5hbGx5IGFzICdtc2VjcycgKGludGVnZXIgbWlsbGlzZWNvbmRzKSBhbmQgJ25zZWNzJ1xuICAvLyAoMTAwLW5hbm9zZWNvbmRzIG9mZnNldCBmcm9tIG1zZWNzKSBzaW5jZSB1bml4IGVwb2NoLCAxOTcwLTAxLTAxIDAwOjAwLlxuICB2YXIgbXNlY3MgPSBvcHRpb25zLm1zZWNzICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLm1zZWNzIDogbmV3IERhdGUoKS5nZXRUaW1lKCk7XG5cbiAgLy8gUGVyIDQuMi4xLjIsIHVzZSBjb3VudCBvZiB1dWlkJ3MgZ2VuZXJhdGVkIGR1cmluZyB0aGUgY3VycmVudCBjbG9ja1xuICAvLyBjeWNsZSB0byBzaW11bGF0ZSBoaWdoZXIgcmVzb2x1dGlvbiBjbG9ja1xuICB2YXIgbnNlY3MgPSBvcHRpb25zLm5zZWNzICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLm5zZWNzIDogX2xhc3ROU2VjcyArIDE7XG5cbiAgLy8gVGltZSBzaW5jZSBsYXN0IHV1aWQgY3JlYXRpb24gKGluIG1zZWNzKVxuICB2YXIgZHQgPSAobXNlY3MgLSBfbGFzdE1TZWNzKSArIChuc2VjcyAtIF9sYXN0TlNlY3MpLzEwMDAwO1xuXG4gIC8vIFBlciA0LjIuMS4yLCBCdW1wIGNsb2Nrc2VxIG9uIGNsb2NrIHJlZ3Jlc3Npb25cbiAgaWYgKGR0IDwgMCAmJiBvcHRpb25zLmNsb2Nrc2VxID09PSB1bmRlZmluZWQpIHtcbiAgICBjbG9ja3NlcSA9IGNsb2Nrc2VxICsgMSAmIDB4M2ZmZjtcbiAgfVxuXG4gIC8vIFJlc2V0IG5zZWNzIGlmIGNsb2NrIHJlZ3Jlc3NlcyAobmV3IGNsb2Nrc2VxKSBvciB3ZSd2ZSBtb3ZlZCBvbnRvIGEgbmV3XG4gIC8vIHRpbWUgaW50ZXJ2YWxcbiAgaWYgKChkdCA8IDAgfHwgbXNlY3MgPiBfbGFzdE1TZWNzKSAmJiBvcHRpb25zLm5zZWNzID09PSB1bmRlZmluZWQpIHtcbiAgICBuc2VjcyA9IDA7XG4gIH1cblxuICAvLyBQZXIgNC4yLjEuMiBUaHJvdyBlcnJvciBpZiB0b28gbWFueSB1dWlkcyBhcmUgcmVxdWVzdGVkXG4gIGlmIChuc2VjcyA+PSAxMDAwMCkge1xuICAgIHRocm93IG5ldyBFcnJvcigndXVpZC52MSgpOiBDYW5cXCd0IGNyZWF0ZSBtb3JlIHRoYW4gMTBNIHV1aWRzL3NlYycpO1xuICB9XG5cbiAgX2xhc3RNU2VjcyA9IG1zZWNzO1xuICBfbGFzdE5TZWNzID0gbnNlY3M7XG4gIF9jbG9ja3NlcSA9IGNsb2Nrc2VxO1xuXG4gIC8vIFBlciA0LjEuNCAtIENvbnZlcnQgZnJvbSB1bml4IGVwb2NoIHRvIEdyZWdvcmlhbiBlcG9jaFxuICBtc2VjcyArPSAxMjIxOTI5MjgwMDAwMDtcblxuICAvLyBgdGltZV9sb3dgXG4gIHZhciB0bCA9ICgobXNlY3MgJiAweGZmZmZmZmYpICogMTAwMDAgKyBuc2VjcykgJSAweDEwMDAwMDAwMDtcbiAgYltpKytdID0gdGwgPj4+IDI0ICYgMHhmZjtcbiAgYltpKytdID0gdGwgPj4+IDE2ICYgMHhmZjtcbiAgYltpKytdID0gdGwgPj4+IDggJiAweGZmO1xuICBiW2krK10gPSB0bCAmIDB4ZmY7XG5cbiAgLy8gYHRpbWVfbWlkYFxuICB2YXIgdG1oID0gKG1zZWNzIC8gMHgxMDAwMDAwMDAgKiAxMDAwMCkgJiAweGZmZmZmZmY7XG4gIGJbaSsrXSA9IHRtaCA+Pj4gOCAmIDB4ZmY7XG4gIGJbaSsrXSA9IHRtaCAmIDB4ZmY7XG5cbiAgLy8gYHRpbWVfaGlnaF9hbmRfdmVyc2lvbmBcbiAgYltpKytdID0gdG1oID4+PiAyNCAmIDB4ZiB8IDB4MTA7IC8vIGluY2x1ZGUgdmVyc2lvblxuICBiW2krK10gPSB0bWggPj4+IDE2ICYgMHhmZjtcblxuICAvLyBgY2xvY2tfc2VxX2hpX2FuZF9yZXNlcnZlZGAgKFBlciA0LjIuMiAtIGluY2x1ZGUgdmFyaWFudClcbiAgYltpKytdID0gY2xvY2tzZXEgPj4+IDggfCAweDgwO1xuXG4gIC8vIGBjbG9ja19zZXFfbG93YFxuICBiW2krK10gPSBjbG9ja3NlcSAmIDB4ZmY7XG5cbiAgLy8gYG5vZGVgXG4gIGZvciAodmFyIG4gPSAwOyBuIDwgNjsgKytuKSB7XG4gICAgYltpICsgbl0gPSBub2RlW25dO1xuICB9XG5cbiAgcmV0dXJuIGJ1ZiA/IGJ1ZiA6IGJ5dGVzVG9VdWlkKGIpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHYxO1xuIiwidmFyIHJuZyA9IHJlcXVpcmUoJy4vbGliL3JuZycpO1xudmFyIGJ5dGVzVG9VdWlkID0gcmVxdWlyZSgnLi9saWIvYnl0ZXNUb1V1aWQnKTtcblxuZnVuY3Rpb24gdjQob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgdmFyIGkgPSBidWYgJiYgb2Zmc2V0IHx8IDA7XG5cbiAgaWYgKHR5cGVvZihvcHRpb25zKSA9PSAnc3RyaW5nJykge1xuICAgIGJ1ZiA9IG9wdGlvbnMgPT09ICdiaW5hcnknID8gbmV3IEFycmF5KDE2KSA6IG51bGw7XG4gICAgb3B0aW9ucyA9IG51bGw7XG4gIH1cbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cbiAgdmFyIHJuZHMgPSBvcHRpb25zLnJhbmRvbSB8fCAob3B0aW9ucy5ybmcgfHwgcm5nKSgpO1xuXG4gIC8vIFBlciA0LjQsIHNldCBiaXRzIGZvciB2ZXJzaW9uIGFuZCBgY2xvY2tfc2VxX2hpX2FuZF9yZXNlcnZlZGBcbiAgcm5kc1s2XSA9IChybmRzWzZdICYgMHgwZikgfCAweDQwO1xuICBybmRzWzhdID0gKHJuZHNbOF0gJiAweDNmKSB8IDB4ODA7XG5cbiAgLy8gQ29weSBieXRlcyB0byBidWZmZXIsIGlmIHByb3ZpZGVkXG4gIGlmIChidWYpIHtcbiAgICBmb3IgKHZhciBpaSA9IDA7IGlpIDwgMTY7ICsraWkpIHtcbiAgICAgIGJ1ZltpICsgaWldID0gcm5kc1tpaV07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGJ1ZiB8fCBieXRlc1RvVXVpZChybmRzKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB2NDtcbiIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMTBfXzsiXSwic291cmNlUm9vdCI6IiJ9